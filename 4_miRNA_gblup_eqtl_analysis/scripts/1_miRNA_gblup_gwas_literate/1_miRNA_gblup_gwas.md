**Script:** `1_miRNA_gblup_gwas.R`

**Directory of Code:**  `/mnt/research/pigeqtl/analyses/microRNA/2_mirna_characterization_expression/4_miRNA_gblup_eqtl_analysis/scripts/`

**Date:**  2/24/16

**Input File Directory:**  `/mnt/research/pigeqtl/analyses/microRNA/2_mirna_characterization_expression/3_build_dge_object_for_eqtl/`

**Input File(s):** 

1. `4_msuprp_mirna_gpdata_pheno_counts.Rdata`

2. `5_normalized_dge_object_and_voom_output.Rata`

3. `6_Z_G_miRNA_gblup_gwas.Rdata`

**Output File Directory:** `/mnt/research/pigeqtl/analyses/microRNA/2_mirna_characterization_expression/4_miRNA_gblup_eqtl_analysis/`

**Output File(s):** `1_gblup_gwa_results_summary_full.Rdata`

**Table of contents:**

1. [Objectives](#objectives)
2. [Install libraries](#install-libraries)
3. [Load data](#load-data)
4. [Analysis](#analysis)
5. [Save data](#save-data)

## Objectives
The objective of this script is to conduct the first gblup and gwa scan for the 174 MSUPRP F2 pig miRNA expression profiles.

This analysis will utilize the gwaR package developed by our lab group: <https://github.com/steibelj/gwaR>

## Install libraries


```r
library(synbreed)
library(regress)
library (limma)
```

```
## Loading required package: methods
```

```r
library (edgeR)
library(gwaR)
library(parallel)
library(qvalue)
```

```
## Warning: replacing previous import by 'grid::arrow' when loading 'qvalue'
```

```
## Warning: replacing previous import by 'grid::unit' when loading 'qvalue'
```

```r
rm(list=ls())
setwd("/mnt/research/pigeqtl/analyses/microRNA/2_mirna_characterization_expression/4_miRNA_gblup_eqtl_analysis/scripts/")
```

## Load data

The final miRNA gpdata object with the voom-adjusted counts as phenotype data:


```r
load("../../3_build_dge_object_for_eqtl/4_msuprp_mirna_gpdata_pheno_counts.Rdata")
```

The normalized dge object and voom centered precision weights:


```r
load("../../3_build_dge_object_for_eqtl/5_normalized_dge_object_and_voom_output.Rata")
```

The standardized Z and G matrices:


```r
load("../../3_build_dge_object_for_eqtl/6_Z_G_miRNA_gblup_gwas.Rdata")
ls()
```

```
## [1] "dge"                        "final_MSUPRP_miRNA"        
## [3] "G"                          "summary_final_MSUPRP_miRNA"
## [5] "v"                          "wtcen"                     
## [7] "Z"
```

## Analysis

Create the design for the GBLUP model:


```r
design_1<-c(~sex + growth_group)
```

Create miRnames, the list of the miRNAs to be input into the gblup analysis:


```r
miRnames<-colnames(final_MSUPRP_miRNA$pheno)
length(miRnames)
```

```
## [1] 295
```

## Run gblup:


```r
system.time({
rst.gblup<-lapply(miRnames, function(x) gblup(rsp=x, data=final_MSUPRP_miRNA, design=design_1, G=G, vdata=NULL, wt=wtcen, pos=c(T,T)))

names(rst.gblup)<-miRnames
})
```

```
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
```

```
##    user  system elapsed 
## 196.469   0.369 197.093
```

Check standard error, if NA eliminate from analysis:


```r
std<-do.call(rbind, lapply(rst.gblup,function(x) x$coefm[6:7,2]))
```

Check how many NAs in standard error:


```r
sum(is.na(rowSums(std)))
```

```
## [1] 0
```

Retain only those miRNAs with a non-NA Standard Error


```r
miRnames<-miRnames[!is.na(rowSums(std))]
length(miRnames)
```

```
## [1] 295
```

Perform Likelihood Ratio Test on gblup results:


```r
system.time({
like<-lapply(rst.gblup, lrt)
names(like)<-miRnames
})
```

```
##    user  system elapsed 
##  19.426   0.041  19.509
```

Multiple test corrections: FDR:

Obtain p-values from LRT


```r
gblup.pval<-unlist(lapply(like, function(x) x$pvalue))
```

Calculate q-values from LRT p-values:


```r
system.time({
	gblup.qval<-qvalue(gblup.pval,lambda=0)$qvalue
})
```

```
##    user  system elapsed 
##   0.011   0.000   0.031
```

Total number of miRNAs with significant h2 at FDR < 0.05


```r
sum(gblup.qval<0.05)
```

```
## [1] 47
```

## Run GWA:

First, transpose standardized Z matrix:


```r
Zt<-t(Z)
dim(Zt)
```

```
## [1] 38319   174
```

```r
system.time({
	rst.gwa<-lapply(miRnames, run.gwa, data=final_MSUPRP_miRNA, design=design_1, G=G, vdata=NULL, wt=wtcen, x=Zt, LRT=F, threshold=0.01, returnz=T, pos=c(T,T))

	names(rst.gwa)<-miRnames
	})
```

```
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## Warning: solution lies close to zero for some positive variance components, their standard errors may not be valid
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
## done with gblup...
## performing association...
```

```
##     user   system  elapsed 
## 1738.703   15.173 1754.350
```

Calculate pvalues from Z-scores (Gualdron Duarte 2014)


```r
system.time({
	gwa.pval<-lapply(rst.gwa, getpvalue, log.p=F, is.z=T)
	})
```

```
##    user  system elapsed 
##   1.267   0.084   1.350
```

Multiple test correction for the GWA: FDR


```r
system.time({
	gwa.qval<-do.call(cbind, lapply(gwa.pval, function(x) qvalue(x)$qvalues))
	})
```

```
##    user  system elapsed 
##  95.469   0.058  96.550
```

Check significance per gene at FDR < 0.01


```r
threshold <- 0.01
sig <- colSums(apply(gwa.qval, 2, "<", threshold))
length(sig[sig!=0])
```

```
## [1] 8
```

```r
sum(sig)
```

```
## [1] 216
```

```r
sig
```

```
##       ssc-let-7a       ssc-let-7c    ssc-let-7d-3p    ssc-let-7d-5p 
##                0                0                0                0 
##       ssc-let-7e       ssc-let-7f       ssc-let-7g       ssc-let-7i 
##                0                0                1                0 
##        ssc-miR-1      ssc-miR-100      ssc-miR-101      ssc-miR-103 
##                0                0                0                0 
##     ssc-miR-106a      ssc-miR-107   ssc-miR-10a-3p   ssc-miR-10a-5p 
##                0                0                0                0 
##      ssc-miR-10b      ssc-miR-122     ssc-miR-1249     ssc-miR-125a 
##                0                0                0                0 
##     ssc-miR-125b   ssc-miR-126-3p   ssc-miR-126-5p      ssc-miR-127 
##                0                0                0                0 
##     ssc-miR-1271     ssc-miR-1277      ssc-miR-128     ssc-miR-1285 
##                0                0                0                0 
##  ssc-miR-1296-5p  ssc-miR-129a-3p  ssc-miR-129a-5p     ssc-miR-129b 
##                0                0                0                0 
##  ssc-miR-1306-3p  ssc-miR-1306-5p     ssc-miR-1307     ssc-miR-130a 
##                1                0                0                0 
##     ssc-miR-130b      ssc-miR-132  ssc-miR-133a-3p  ssc-miR-133a-5p 
##                0                0                0                0 
##     ssc-miR-133b     ssc-miR-1343      ssc-miR-135      ssc-miR-136 
##                0                0                0                0 
##      ssc-miR-137      ssc-miR-138   ssc-miR-139-3p   ssc-miR-139-5p 
##                0                0                0                0 
##   ssc-miR-140-3p   ssc-miR-140-5p   ssc-miR-142-3p   ssc-miR-142-5p 
##                0                3                0                0 
##   ssc-miR-143-3p   ssc-miR-143-5p      ssc-miR-144   ssc-miR-145-3p 
##                0                0                0                0 
##   ssc-miR-145-5p     ssc-miR-1468  ssc-miR-146a-5p     ssc-miR-146b 
##                0                0                0                0 
##  ssc-miR-148a-3p  ssc-miR-148a-5p  ssc-miR-148b-3p  ssc-miR-148b-5p 
##                0                0                0                0 
##      ssc-miR-149      ssc-miR-150   ssc-miR-151-3p   ssc-miR-151-5p 
##                0                0                0                0 
##      ssc-miR-152      ssc-miR-153   ssc-miR-155-5p      ssc-miR-15a 
##                0                0                0                0 
##      ssc-miR-15b       ssc-miR-16    ssc-miR-17-3p    ssc-miR-17-5p 
##                0                0                0                0 
##     ssc-miR-181a     ssc-miR-181b     ssc-miR-181c  ssc-miR-181d-5p 
##                0                0                0                0 
##      ssc-miR-182      ssc-miR-183  ssc-miR-1839-5p      ssc-miR-184 
##                0                0                0               30 
##      ssc-miR-185      ssc-miR-186      ssc-miR-187      ssc-miR-18a 
##                0                0                0                0 
##      ssc-miR-18b     ssc-miR-190a     ssc-miR-190b      ssc-miR-191 
##                0                0                0                0 
##      ssc-miR-192  ssc-miR-193a-3p  ssc-miR-193a-5p     ssc-miR-194a 
##                0                0                0                0 
##      ssc-miR-195     ssc-miR-196a  ssc-miR-196b-3p  ssc-miR-196b-5p 
##                0                0                0                0 
##  ssc-miR-199a-3p  ssc-miR-199a-5p  ssc-miR-199b-3p  ssc-miR-199b-5p 
##                0                0                0                0 
##      ssc-miR-19a      ssc-miR-19b   ssc-miR-202-5p      ssc-miR-204 
##                0                0                0                0 
##      ssc-miR-205      ssc-miR-206     ssc-miR-208b      ssc-miR-20a 
##                0                0                0                0 
##      ssc-miR-20b       ssc-miR-21      ssc-miR-210      ssc-miR-212 
##                0                0                0                0 
##      ssc-miR-214      ssc-miR-216      ssc-miR-217      ssc-miR-218 
##                0                0                0                0 
##   ssc-miR-218-5p     ssc-miR-218b     ssc-miR-219a   ssc-miR-221-3p 
##                0                0                0                0 
##   ssc-miR-221-5p      ssc-miR-222    ssc-miR-22-3p    ssc-miR-22-5p 
##                0                0                0                0 
##  ssc-miR-2320-3p  ssc-miR-2320-5p     ssc-miR-2366      ssc-miR-23a 
##                0                0                0                0 
##      ssc-miR-23b     ssc-miR-2411  ssc-miR-24-1-5p  ssc-miR-24-2-5p 
##                0                0                0                0 
##    ssc-miR-24-3p     ssc-miR-2483      ssc-miR-26a      ssc-miR-27a 
##                0                0                0                0 
##   ssc-miR-27b-3p   ssc-miR-27b-5p    ssc-miR-28-3p    ssc-miR-28-5p 
##                0                0                0                0 
##   ssc-miR-296-3p   ssc-miR-296-5p      ssc-miR-299      ssc-miR-29a 
##                0                0                0                0 
##      ssc-miR-29b      ssc-miR-29c      ssc-miR-301   ssc-miR-30a-3p 
##                0                0                0                0 
##   ssc-miR-30a-5p   ssc-miR-30b-3p   ssc-miR-30b-5p ssc-miR-30c-1-3p 
##                0                0                0                0 
##   ssc-miR-30c-3p   ssc-miR-30c-5p      ssc-miR-30d   ssc-miR-30e-3p 
##                0                0                0                0 
##   ssc-miR-30e-5p       ssc-miR-31       ssc-miR-32      ssc-miR-320 
##                0                0                0                0 
##      ssc-miR-323      ssc-miR-324      ssc-miR-326      ssc-miR-328 
##                0                0                0                0 
##   ssc-miR-331-3p   ssc-miR-331-5p      ssc-miR-335      ssc-miR-338 
##                0                0                0                0 
##      ssc-miR-339   ssc-miR-339-3p   ssc-miR-339-5p      ssc-miR-340 
##                0                0                0                0 
##      ssc-miR-342   ssc-miR-345-3p   ssc-miR-345-5p      ssc-miR-34a 
##                0                0                0                0 
##      ssc-miR-34c     ssc-miR-3613   ssc-miR-361-3p   ssc-miR-361-5p 
##                0                0                0                0 
##      ssc-miR-362      ssc-miR-363   ssc-miR-365-3p   ssc-miR-365-5p 
##                0                0                0                0 
##      ssc-miR-369      ssc-miR-370  ssc-miR-374a-3p  ssc-miR-374a-5p 
##                0                0                0                0 
##  ssc-miR-374b-3p  ssc-miR-374b-5p  ssc-miR-376a-3p  ssc-miR-376a-5p 
##                0                0                0                0 
##     ssc-miR-376c      ssc-miR-378  ssc-miR-378b-3p      ssc-miR-381 
##                0                0                0                0 
##      ssc-miR-382      ssc-miR-411   ssc-miR-421-3p   ssc-miR-423-3p 
##                0                0                0                0 
##   ssc-miR-423-5p   ssc-miR-424-3p   ssc-miR-424-5p   ssc-miR-425-3p 
##                0                0                0                0 
##   ssc-miR-425-5p      ssc-miR-429   ssc-miR-432-5p     ssc-miR-4331 
##                0               93                0                0 
##     ssc-miR-4332  ssc-miR-4334-3p     ssc-miR-450a  ssc-miR-450b-3p 
##                0                0                0                0 
##  ssc-miR-450b-5p  ssc-miR-450c-3p  ssc-miR-450c-5p      ssc-miR-451 
##                0                0                0                0 
##      ssc-miR-452   ssc-miR-455-3p   ssc-miR-455-5p      ssc-miR-486 
##                0                0                0                0 
##     ssc-miR-487b      ssc-miR-489      ssc-miR-490   ssc-miR-490-3p 
##                0                0                0                0 
##      ssc-miR-491   ssc-miR-493-3p   ssc-miR-493-5p      ssc-miR-497 
##                0                0                0                0 
##   ssc-miR-499-3p   ssc-miR-499-5p      ssc-miR-500      ssc-miR-503 
##                0                0                0                0 
##      ssc-miR-504      ssc-miR-505   ssc-miR-532-3p   ssc-miR-532-5p 
##                0                0                0                0 
##   ssc-miR-542-3p   ssc-miR-542-5p   ssc-miR-545-3p   ssc-miR-545-5p 
##                0                0                0                0 
##     ssc-miR-551a      ssc-miR-574      ssc-miR-582      ssc-miR-615 
##                0                0                0                0 
##      ssc-miR-628      ssc-miR-652   ssc-miR-664-3p   ssc-miR-664-5p 
##                0                0                0                0 
##   ssc-miR-671-3p   ssc-miR-671-5p   ssc-miR-676-3p  ssc-miR-6782-3p 
##                0                0                0                3 
##        ssc-miR-7   ssc-miR-708-3p   ssc-miR-708-5p  ssc-miR-7134-3p 
##                0                0                0                0 
##  ssc-miR-7134-5p  ssc-miR-7135-3p  ssc-miR-7135-5p  ssc-miR-7137-3p 
##                0                0                0                0 
##  ssc-miR-7137-5p  ssc-miR-7138-5p  ssc-miR-7139-5p  ssc-miR-7142-3p 
##                0                0                0                0 
##  ssc-miR-7144-5p      ssc-miR-744      ssc-miR-758   ssc-miR-769-3p 
##                0                0                0                0 
##   ssc-miR-769-5p  ssc-miR-7857-3p      ssc-miR-874   ssc-miR-885-3p 
##                0                0               83                0 
##   ssc-miR-885-5p        ssc-miR-9      ssc-miR-9-1      ssc-miR-9-2 
##                0                0                0                0 
##      ssc-miR-92a   ssc-miR-92b-3p      ssc-miR-935       ssc-miR-95 
##                0                0                0                0 
##    ssc-miR-96-5p  ssc-miR-9785-5p       ssc-miR-98  ssc-miR-9810-3p 
##                0                0                0                0 
##  ssc-miR-9820-5p  ssc-miR-9841-3p  ssc-miR-9843-3p  ssc-miR-9851-3p 
##                0                0                2                0 
##  ssc-miR-9860-5p      ssc-miR-99a      ssc-miR-99b 
##                0                0                0
```

Check significance per gene at FDR < 0.05:


```r
threshold5 <- 0.05
sig5 <- colSums(apply(gwa.qval, 2 , "<", threshold5))
length(sig5[sig5!=0])
```

```
## [1] 18
```

```r
sum(sig5)
```

```
## [1] 367
```

```r
sig5
```

```
##       ssc-let-7a       ssc-let-7c    ssc-let-7d-3p    ssc-let-7d-5p 
##                0                0                0                4 
##       ssc-let-7e       ssc-let-7f       ssc-let-7g       ssc-let-7i 
##                0                0                2                0 
##        ssc-miR-1      ssc-miR-100      ssc-miR-101      ssc-miR-103 
##                0                0                0                0 
##     ssc-miR-106a      ssc-miR-107   ssc-miR-10a-3p   ssc-miR-10a-5p 
##                0                0                0                0 
##      ssc-miR-10b      ssc-miR-122     ssc-miR-1249     ssc-miR-125a 
##                0                0                0                0 
##     ssc-miR-125b   ssc-miR-126-3p   ssc-miR-126-5p      ssc-miR-127 
##                0                0                0                0 
##     ssc-miR-1271     ssc-miR-1277      ssc-miR-128     ssc-miR-1285 
##                0                0                1                0 
##  ssc-miR-1296-5p  ssc-miR-129a-3p  ssc-miR-129a-5p     ssc-miR-129b 
##                0                0                0                0 
##  ssc-miR-1306-3p  ssc-miR-1306-5p     ssc-miR-1307     ssc-miR-130a 
##                1                0                0                0 
##     ssc-miR-130b      ssc-miR-132  ssc-miR-133a-3p  ssc-miR-133a-5p 
##                0                0                0                0 
##     ssc-miR-133b     ssc-miR-1343      ssc-miR-135      ssc-miR-136 
##                0                0                0                0 
##      ssc-miR-137      ssc-miR-138   ssc-miR-139-3p   ssc-miR-139-5p 
##                0                0                0                0 
##   ssc-miR-140-3p   ssc-miR-140-5p   ssc-miR-142-3p   ssc-miR-142-5p 
##                0                4                0                0 
##   ssc-miR-143-3p   ssc-miR-143-5p      ssc-miR-144   ssc-miR-145-3p 
##                0                0                0                0 
##   ssc-miR-145-5p     ssc-miR-1468  ssc-miR-146a-5p     ssc-miR-146b 
##                0                1                0                0 
##  ssc-miR-148a-3p  ssc-miR-148a-5p  ssc-miR-148b-3p  ssc-miR-148b-5p 
##                0                0                0                0 
##      ssc-miR-149      ssc-miR-150   ssc-miR-151-3p   ssc-miR-151-5p 
##                0                0                0                0 
##      ssc-miR-152      ssc-miR-153   ssc-miR-155-5p      ssc-miR-15a 
##                0                0                0                0 
##      ssc-miR-15b       ssc-miR-16    ssc-miR-17-3p    ssc-miR-17-5p 
##                0                0                0                0 
##     ssc-miR-181a     ssc-miR-181b     ssc-miR-181c  ssc-miR-181d-5p 
##                0                0                0                0 
##      ssc-miR-182      ssc-miR-183  ssc-miR-1839-5p      ssc-miR-184 
##                0                0                0               54 
##      ssc-miR-185      ssc-miR-186      ssc-miR-187      ssc-miR-18a 
##                0                0                0                0 
##      ssc-miR-18b     ssc-miR-190a     ssc-miR-190b      ssc-miR-191 
##                0                0               24                0 
##      ssc-miR-192  ssc-miR-193a-3p  ssc-miR-193a-5p     ssc-miR-194a 
##                0                0                0                0 
##      ssc-miR-195     ssc-miR-196a  ssc-miR-196b-3p  ssc-miR-196b-5p 
##                0                0                0                0 
##  ssc-miR-199a-3p  ssc-miR-199a-5p  ssc-miR-199b-3p  ssc-miR-199b-5p 
##                0                0                0                0 
##      ssc-miR-19a      ssc-miR-19b   ssc-miR-202-5p      ssc-miR-204 
##                0                0                0                0 
##      ssc-miR-205      ssc-miR-206     ssc-miR-208b      ssc-miR-20a 
##                0                0                0                0 
##      ssc-miR-20b       ssc-miR-21      ssc-miR-210      ssc-miR-212 
##                0                0                0                0 
##      ssc-miR-214      ssc-miR-216      ssc-miR-217      ssc-miR-218 
##                0                0                0                0 
##   ssc-miR-218-5p     ssc-miR-218b     ssc-miR-219a   ssc-miR-221-3p 
##                0                0                0                0 
##   ssc-miR-221-5p      ssc-miR-222    ssc-miR-22-3p    ssc-miR-22-5p 
##                0                0               13                0 
##  ssc-miR-2320-3p  ssc-miR-2320-5p     ssc-miR-2366      ssc-miR-23a 
##                0                0                0                0 
##      ssc-miR-23b     ssc-miR-2411  ssc-miR-24-1-5p  ssc-miR-24-2-5p 
##                0                0                0                0 
##    ssc-miR-24-3p     ssc-miR-2483      ssc-miR-26a      ssc-miR-27a 
##                0                0                0                0 
##   ssc-miR-27b-3p   ssc-miR-27b-5p    ssc-miR-28-3p    ssc-miR-28-5p 
##                0                0                0                0 
##   ssc-miR-296-3p   ssc-miR-296-5p      ssc-miR-299      ssc-miR-29a 
##                0                0                0                0 
##      ssc-miR-29b      ssc-miR-29c      ssc-miR-301   ssc-miR-30a-3p 
##                0                0                0                0 
##   ssc-miR-30a-5p   ssc-miR-30b-3p   ssc-miR-30b-5p ssc-miR-30c-1-3p 
##                0                0                0                0 
##   ssc-miR-30c-3p   ssc-miR-30c-5p      ssc-miR-30d   ssc-miR-30e-3p 
##                0                0                0                0 
##   ssc-miR-30e-5p       ssc-miR-31       ssc-miR-32      ssc-miR-320 
##                0                0                0                0 
##      ssc-miR-323      ssc-miR-324      ssc-miR-326      ssc-miR-328 
##                0                0                0                0 
##   ssc-miR-331-3p   ssc-miR-331-5p      ssc-miR-335      ssc-miR-338 
##                0                0                0                0 
##      ssc-miR-339   ssc-miR-339-3p   ssc-miR-339-5p      ssc-miR-340 
##                0                0                0                0 
##      ssc-miR-342   ssc-miR-345-3p   ssc-miR-345-5p      ssc-miR-34a 
##                0                4                0                0 
##      ssc-miR-34c     ssc-miR-3613   ssc-miR-361-3p   ssc-miR-361-5p 
##                0                0                0                0 
##      ssc-miR-362      ssc-miR-363   ssc-miR-365-3p   ssc-miR-365-5p 
##                0                0                0                0 
##      ssc-miR-369      ssc-miR-370  ssc-miR-374a-3p  ssc-miR-374a-5p 
##                0                0                0                0 
##  ssc-miR-374b-3p  ssc-miR-374b-5p  ssc-miR-376a-3p  ssc-miR-376a-5p 
##                0                0                0                0 
##     ssc-miR-376c      ssc-miR-378  ssc-miR-378b-3p      ssc-miR-381 
##                0                0                0                0 
##      ssc-miR-382      ssc-miR-411   ssc-miR-421-3p   ssc-miR-423-3p 
##                0                0                0                0 
##   ssc-miR-423-5p   ssc-miR-424-3p   ssc-miR-424-5p   ssc-miR-425-3p 
##                0                0                0                0 
##   ssc-miR-425-5p      ssc-miR-429   ssc-miR-432-5p     ssc-miR-4331 
##                0               94                0                0 
##     ssc-miR-4332  ssc-miR-4334-3p     ssc-miR-450a  ssc-miR-450b-3p 
##                0                0                0                0 
##  ssc-miR-450b-5p  ssc-miR-450c-3p  ssc-miR-450c-5p      ssc-miR-451 
##                0                0                0                0 
##      ssc-miR-452   ssc-miR-455-3p   ssc-miR-455-5p      ssc-miR-486 
##                0                0                0                0 
##     ssc-miR-487b      ssc-miR-489      ssc-miR-490   ssc-miR-490-3p 
##                0                0                0                0 
##      ssc-miR-491   ssc-miR-493-3p   ssc-miR-493-5p      ssc-miR-497 
##                0                0                0                0 
##   ssc-miR-499-3p   ssc-miR-499-5p      ssc-miR-500      ssc-miR-503 
##                0                0                0                0 
##      ssc-miR-504      ssc-miR-505   ssc-miR-532-3p   ssc-miR-532-5p 
##                0                0                0                0 
##   ssc-miR-542-3p   ssc-miR-542-5p   ssc-miR-545-3p   ssc-miR-545-5p 
##                0                0                0                0 
##     ssc-miR-551a      ssc-miR-574      ssc-miR-582      ssc-miR-615 
##                0                0                0                0 
##      ssc-miR-628      ssc-miR-652   ssc-miR-664-3p   ssc-miR-664-5p 
##                0                0                0                0 
##   ssc-miR-671-3p   ssc-miR-671-5p   ssc-miR-676-3p  ssc-miR-6782-3p 
##                0                0                0                4 
##        ssc-miR-7   ssc-miR-708-3p   ssc-miR-708-5p  ssc-miR-7134-3p 
##                0                0                0                0 
##  ssc-miR-7134-5p  ssc-miR-7135-3p  ssc-miR-7135-5p  ssc-miR-7137-3p 
##                0               15                0                0 
##  ssc-miR-7137-5p  ssc-miR-7138-5p  ssc-miR-7139-5p  ssc-miR-7142-3p 
##                0                0                0                0 
##  ssc-miR-7144-5p      ssc-miR-744      ssc-miR-758   ssc-miR-769-3p 
##                0                0                0                0 
##   ssc-miR-769-5p  ssc-miR-7857-3p      ssc-miR-874   ssc-miR-885-3p 
##                0                0              118                0 
##   ssc-miR-885-5p        ssc-miR-9      ssc-miR-9-1      ssc-miR-9-2 
##                0                0                0                0 
##      ssc-miR-92a   ssc-miR-92b-3p      ssc-miR-935       ssc-miR-95 
##                0                0                0                4 
##    ssc-miR-96-5p  ssc-miR-9785-5p       ssc-miR-98  ssc-miR-9810-3p 
##                0               18                0                2 
##  ssc-miR-9820-5p  ssc-miR-9841-3p  ssc-miR-9843-3p  ssc-miR-9851-3p 
##                0                0                4                0 
##  ssc-miR-9860-5p      ssc-miR-99a      ssc-miR-99b 
##                0                0                0
```

Matrix of gblup results:


```r
summary.rst.gblup<-do.call(rbind, 
	lapply(miRnames, function(x) cbind(t(like[[x]]$vars[1]),
	 h2=like[[x]]$vars[1,3],
		like[[x]]$llik,
		lrtpvalue=like[[x]]$pvalue)))

rownames(summary.rst.gblup)<-miRnames

head(summary.rst.gblup)
```

```
##                         G         wt         h2      full       red
## ssc-let-7a    0.006807096 0.06093209 0.10048979 144.07988 143.08875
## ssc-let-7c    0.004927799 0.06745232 0.06808222 138.02078 137.65134
## ssc-let-7d-3p 0.011460127 0.26584155 0.04132729  24.21787  24.09533
## ssc-let-7d-5p 0.012289637 0.09770906 0.11172529 103.31353 101.91083
## ssc-let-7e    0.011015893 0.14132276 0.07231187  75.22074  74.53212
## ssc-let-7f    0.006893517 0.11065848 0.05864228  96.92597  96.57675
##                     dif  lrtpvalue
## ssc-let-7a    0.9911330 0.07957594
## ssc-let-7c    0.3694356 0.19501134
## ssc-let-7d-3p 0.1225381 0.31028178
## ssc-let-7d-5p 1.4026950 0.04697400
## ssc-let-7e    0.6886229 0.12028542
## ssc-let-7f    0.3492133 0.20165645
```

Matrix of standard errors of GBLUP:


```r
std<-std[miRnames,]
colnames(std)<-paste("stdEr", colnames(std), sep="-")
```

Matrix of GWA Zscores:


```r
rst.gwa<-do.call(cbind,rst.gwa)
```

Matrix of pvalues from GWA:


```r
gwa.pval<-do.call(cbind, gwa.pval)
```

Merge eQTL results into one R object:


```r
eqtl<-list(gblup=cbind(summary.rst.gblup[,1:3], std, summary.rst.gblup[,4:7], qvalue=gblup.qval), gwa=rst.gwa, gwa.pval=gwa.pval, gwa.qval=gwa.qval)
```

## Save data



```r
save(eqtl, file="../1_gblup_gwa_results_summary_full.Rdata")
```

